---
title: "Dashboard"
output: 
  flexdashboard::flex_dashboard:
    orientation: columns
    vertical_layout: fill
    source: embed
---

```{r setup, include=FALSE}
library(tidyverse)
library(p8105.datasets)
library(plotly)
library(flexdashboard)
```

```{r}
data("ny_noaa")

ny_noaa_fixed = ny_noaa %>%
  separate(date, sep="-", into = c("year", "month", "day")) %>%
  mutate(
   year = as.integer(year),
   month = as.integer(month),
   day = as.integer(day),
   tmax = as.numeric(tmax),
   tmin = as.numeric(tmin),
   tmax = tmax / 10,
   tmin = tmin / 10
  )
```


Column {data-width=650}
-----------------------------------------------------------------------

### Chart A

```{r}

set.seed(1)
ny_noaa_fixed %>% 
  filter(year > 2009) %>%
  sample_n(60000) %>%
  mutate(text_label = str_c("Month: ", month, "\nYear: ", year)) %>% 
  plot_ly(
    x = ~tmax, y = ~tmin, color = ~factor(month), text = ~text_label, 
    alpha = .5, type = "scatter", mode = "markers") %>%
  layout(
    title = "NY Weather of 2010 looking at Min and Max Temp ")

```

Column {data-width=350}
-----------------------------------------------------------------------

### Chart B

```{r}
ny_noaa_fixed %>% 
  filter(year > 2004) %>%
  filter(month %in% c(12,1,2,3)) %>%
  filter(snow >0) %>%
  count(snow) %>% 
  mutate(snow = factor(snow) ) %>% #fct_reorder(factor(snow), n)) %>% 
  plot_ly(
    x = ~snow, y = ~n, color = ~snow, 
    type = "bar", colors = "viridis")  %>%
  layout(
    title = "Daily Snow fall (mm) in Winter Months of Years 2005-2010 ")
```

### Chart C

```{r}
ny_noaa_fixed %>% 
 filter(month == c(1,7)) %>%
  mutate(year = factor(year), month = factor(month)) %>% 
  mutate(
    month = ifelse( month == 1, "January", "July")
  ) %>%
  plot_ly(
    y = ~year, x = ~tmax, color = ~month,
    type = "box", colors = "viridis") %>%
  layout(
    title = "NY Weather Over the Years in 2 Months ")

```
